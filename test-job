pipeline {
  agent any
  triggers {
    cron('0 12 * * *') // Trigger at 12:00 PM (noon)
    cron('0 15 * * *') // Trigger at 3:00 PM
  }
  stages {
    stage('Define Environment Variables') {
      steps {
        script {
          def appNames = ["harnessweb", "harvey-integration", "judgesAssistant", "stewards-portal", "webapi"]
          def EnvironmentName = "dev"

          currentBuild.withContext {
            env.appNames = appNames.join(',')
            env.EnvironmentName = EnvironmentName
          }
        }
      }
    }
    stage('Print Greeting') {
      steps {
        script {
          def currentHour = new Date().format("HH")
          if (currentHour == "12") {
            echo "Hello Day"
          } else if (currentHour == "15") {
            echo "Hello Afternoon"
          } else {
            echo "No greeting for this time."
          }
        }
      }
    }
    stage('LOOP') {
      steps {
        script {
          def appNames = env.appNames.split(',')
          def EnvironmentName = env.EnvironmentName
          appNames.each { appName ->
            stage("Deploy ${appName} Stack") {
              steps {
                script {
                  def constructedString = "rise-${appName}-${EnvironmentName}-ASG"
                  echo constructedString
                }
              }
            }
          }
        }
      }
    }
  }
}
